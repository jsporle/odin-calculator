<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Joshio Calculator</title>
    <link rel="stylesheet" href="styles.css"> 
</head>
<body>
    <script>
        //create calculator container
        const calcCont = document.createElement("div");
        calcCont.classList.add("calc-container");
        document.body.appendChild(calcCont);
        
        //create display
            //display container
        const dispCont = document.createElement("div");
        dispCont.classList.add("disp-container");
        calcCont.appendChild(dispCont);
                //input display
            const dispInput = document.createElement("div");
            dispInput.classList.add("disp-input");
            dispCont.appendChild(dispInput);
                //output display
            const dispOutput = document.createElement("div");
            dispOutput.classList.add("disp-output");
            dispCont.appendChild(dispOutput);
        
        //create buttons
            //buttons container
        const buttonsCont = document.createElement("div");
        buttonsCont.classList.add("buttons-container");
        calcCont.appendChild(buttonsCont);
                //numerical buttons
            const numBtnCont = document.createElement("div");
            numBtnCont.classList.add("num-buttons-container");
            buttonsCont.appendChild(numBtnCont);

            const numberButtons = [`.`, 0, `AC`, 1, 2, 3, 4, 5, 6, 7, 8, 9];
            [...numberButtons].reverse().forEach((item) => {
                const numBtn = document.createElement("button");
                numBtn.textContent = item;
                numBtn.className = "integer";
                numBtnCont.appendChild(numBtn);
            })

                //operation buttons
            const opBtnCont = document.createElement("div");
            opBtnCont.classList.add("op-buttons-container");
            buttonsCont.appendChild(opBtnCont);

            const operationButtons = ["+", "-", "*", "/", "="];
            operationButtons.forEach((item) => {
                const opBtn = document.createElement("button");
                opBtn.textContent = item;
                opBtn.className = "operation";
                opBtnCont.appendChild(opBtn);
            })

        //buttons update display
            //input buttons will add to input display string
            //number listener
            numBtnCont.addEventListener("click", (clickNumber) => {
                if (clickNumber.target.tagName === 'BUTTON') {
                    dispInput.textContent += clickNumber.target.textContent;
                }
            });

            //operation listener
            opBtnCont.addEventListener("click", (clickOperation) => {
                if (clickOperation.target.tagName === 'BUTTON') {
                    const op = clickOperation.target.textContent;
                    const currentDisplay = dispInput.textContent;
                    const lastEntry = currentDisplay.slice(-1);

                    const isLastEntryNumber = lastEntry >= '0' && lastEntry <= '9';

                    if (op === '*' || op === '/') {        //multiply and divide can't be used unless a number is already on the display 
                        if (isLastEntryNumber) {
                            dispInput.textContent += op;
                        }
                    } else if (op === '=') {
                        //equals button will update output display
                        const outputSend = calculateInput(dispInput.textContent);
                        dispOutput.textContent = outputSend;
                        //equals button will repeat the last operation if hit again
                    } else {
                    dispInput.textContent += op;
                    }
                }
            });

            //input cleaning, send to output
            function calculateInput(input) {
                let cleanInput = input
                .replaceAll('++', '+')
                .replaceAll('--', '+')
                .replaceAll('+-', '-')
                .replaceAll('-+', '-');

                try {
                    const calculation = new Function(`return ${cleanInput}`)();
                    return calculation; 
                } catch (error) {
                    return "ERROR!";
                };
            };

            

            
            //AC button will clear the display
            //DEL button will remove the last character
            //keyboard can be used

        //decimals can only be used once for each number (between each operational button)

        
        

    </script>
    
</body>
</html>